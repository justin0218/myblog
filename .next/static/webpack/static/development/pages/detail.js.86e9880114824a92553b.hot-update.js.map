{"version":3,"file":"static/webpack/static/development/pages/detail.js.86e9880114824a92553b.hot-update.js","sources":["webpack:///./pages/detail.js"],"sourcesContent":["import Layout from '../components/layout'\nimport {getTpValue} from '../utils/blog_types'\nimport moment from 'moment'\nimport {apiHost} from '../utils/config';\nimport protobuf from \"../proto/blog_pb\";\nimport axios from 'axios'\nimport readStream from '../utils/util'\n\nexport default class extends React.Component {\n  static async getInitialProps({ req,query,jsonPageRes }) {\n    const userAgent = req ? req.headers['user-agent'] : navigator.userAgent\n    return { userAgent,query,jsonPageRes }\n  }\n\n  state = {\n      blogDtail:\"\",\n      detailData:{}\n  }\n\n  async componentDidMount(){\n      const {id} = this.props.query\n\n      axios({\n        method:'get',\n        url: `http://localhost:29000/v1/blog/detail?id=${id}`,\n        headers: { 'contentType':'application/x-protobuf'} }).then(async (res) => {\n          console.log(res.data);\n          let message = protobuf.detail.deserializeBinary(res.data);\n      let data = message.toObject();\n      let key = data.htmlTxtUrl.replace(\"http:\"+apiHost + \"/redources/\",\"\")\n      let detailHtml = await fetch(`${apiHost}/tool/file/read?key=${key}`);\n      detailHtml = await detailHtml.text()\n      console.log(id)\n      this.setState({blogDtail:detailHtml,detailData:data})\n      }).catch((error) => {\n        console.log(error)\n      })\n\n      // let res = await axios.get(`http://localhost:29000/v1/blog/detail?id=${id}`,{\n      //   responseType: 'application/x-protobuf'\n      // })\n      // console.log(res.data);\n      // let data = await readStream(res.data)\n      // let message = protobuf.detail.deserializeBinary(res.data);\n      // let data = message.toObject();\n      // let key = data.htmlTxtUrl.replace(\"http:\"+apiHost + \"/redources/\",\"\")\n      // let detailHtml = await fetch(`${apiHost}/tool/file/read?key=${key}`);\n      // detailHtml = await detailHtml.text()\n      // console.log(id)\n      // this.setState({blogDtail:detailHtml,detailData:data})\n  }\n\n  render() {\n    const {blogDtail,detailData} = this.state\n    return (\n      <Layout>\n          <div style={{background:\"#fff\",padding: \"0 30px\"}}>\n            <h3 className=\"news_title\">{detailData.name}</h3>\n            <div className=\"bloginfo\">\n              <ul>\n                <li className=\"author\"></li>\n                <li className=\"lmname\">{getTpValue(detailData.type)}</li>\n                <li className=\"timer\">{moment(detailData.update_time).format(\"YYYY-MM-DD\")}</li>\n                <li className=\"view\">{detailData.preview} 人已阅读</li>\n              </ul>\n            </div>\n            <div style={{clear:'both'}}></div>\n            <div className=\"news_about\">\n              <strong>简介</strong> {detailData.preface}\n            </div>\n            <div dangerouslySetInnerHTML={{__html: blogDtail}} className=\"markdown-body editormd-preview-container\" previewcontainer=\"true\" style={{padding: 8,width:\"auto\"}}></div>\n          </div>\n          <style jsx>{`\n           .news_about {\n                color: #888888;\n                border: 1px solid #F3F3F3;\n                padding: 10px;\n                margin: 20px auto 15px auto;\n                line-height: 23px;\n                background: none repeat 0 0 #F6F6F6;\n            }\n            .bloginfo {\n              width: 100%;\n              overflow: hidden;\n            }\n            .news_title {\n                font-size: 24px;\n                font-weight: normal;\n                padding: 20px 0;\n                color: #333;\n                margin:0;\n            }\n            .bloginfo li {\n                float: left;\n                margin-right: 20px;\n                list-style: none;\n            }\n          `}</style>\n      </Layout>     \n    )\n  }\n}\n\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;AAOA;AACA;AACA;AAFA;AACA;;;;;;;;;;;;;;;;;AAKA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAJA;AAAA;AACA;AADA;AAKA;AALA;AAAA;AACA;AADA;AAMA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAJA;AAAA;AAAA;AAAA;AAaA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;AAEA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAfA;AAAA;AAAA;AA6CA;;;;;;;;;;;;AA3FA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;;;;;;;;AAJA;AACA;;;;;A","sourceRoot":""}