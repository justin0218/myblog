{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/justin/Desktop/private/nextjs/pages/detail.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nimport Layout from '../components/layout';\nimport { getTpValue } from '../utils/blog_types';\nimport moment from 'moment';\nimport { apiHost } from '../utils/config';\nimport protobuf from \"../proto/blog_pb\";\nimport axios from 'axios';\nimport readStream from '../utils/util';\n\nvar _default =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(_default, _React$Component);\n\n  function _default() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, _default);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(_default)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      blogDtail: \"\",\n      detailData: {},\n      commentsList: [],\n      commentTotal: 0,\n      saytext: \"\",\n      loadings: {\n        \"comment\": false\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(_default, [{\n    key: \"getComments\",\n    value: function () {\n      var _getComments = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var id, commentRes, commentData, commentMessage;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                id = this.props.query.id;\n                this.setState({\n                  loadings: {\n                    comment: true\n                  }\n                });\n                _context.next = 4;\n                return axios.get(\"\".concat(apiHost, \"/v1/blog/messageboard/list?blog_id=\").concat(id), {\n                  responseType: 'blob'\n                });\n\n              case 4:\n                commentRes = _context.sent;\n                _context.next = 7;\n                return readStream(commentRes.data);\n\n              case 7:\n                commentData = _context.sent;\n                commentMessage = protobuf.blogComments.deserializeBinary(commentData);\n                commentMessage = commentMessage.toObject();\n                this.setState({\n                  commentsList: commentMessage.listList,\n                  commentTotal: commentMessage.total\n                });\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getComments() {\n        return _getComments.apply(this, arguments);\n      }\n\n      return getComments;\n    }()\n  }, {\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        var id, res, data, message, hres, hdata, hmessage;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                id = this.props.query.id;\n                _context2.next = 3;\n                return axios.get(\"\".concat(apiHost, \"/v1/blog/detail?id=\").concat(id), {\n                  responseType: 'blob'\n                });\n\n              case 3:\n                res = _context2.sent;\n                _context2.next = 6;\n                return readStream(res.data);\n\n              case 6:\n                data = _context2.sent;\n                message = protobuf.detailRes.deserializeBinary(data);\n                data = message.toObject(); // console.log(data)\n\n                _context2.next = 11;\n                return axios.get(\"\".concat(apiHost, \"/tool/file/read?key=\").concat(data.htmlTxtUrl), {\n                  responseType: 'blob'\n                });\n\n              case 11:\n                hres = _context2.sent;\n                _context2.next = 14;\n                return readStream(hres.data);\n\n              case 14:\n                hdata = _context2.sent;\n                hmessage = protobuf.fileReadRes.deserializeBinary(hdata);\n                hdata = hmessage.toObject();\n                _context2.next = 19;\n                return this.getComments();\n\n              case 19:\n                this.setState({\n                  blogDtail: hdata.txt,\n                  detailData: data\n                });\n\n              case 20:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"subMitComment\",\n    value: function () {\n      var _subMitComment = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        var saytext, id, message, bytes, res;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                this.setState({\n                  loadings: {\n                    comment: true\n                  }\n                });\n                saytext = this.state.saytext;\n                id = this.props.query.id;\n                message = new protobuf.blogComment();\n                message.setContent(saytext);\n                message.setBlogId(id);\n                bytes = message.serializeBinary();\n                _context3.prev = 7;\n                _context3.next = 10;\n                return axios.post(\"\".concat(apiHost, \"/v1/blog/messageboard/submit\"), bytes, {\n                  headers: {\n                    'Content-Type': 'application/octet-stream'\n                  }\n                });\n\n              case 10:\n                res = _context3.sent;\n                _context3.next = 13;\n                return this.getComments();\n\n              case 13:\n                _context3.next = 19;\n                break;\n\n              case 15:\n                _context3.prev = 15;\n                _context3.t0 = _context3[\"catch\"](7);\n                console.log(_context3.t0);\n\n                if (_context3.t0 == \"Error: Request failed with status code 400\") {\n                  alert(\"评论内容不能为空\");\n                } else if (_context3.t0 == \"Error: Request failed with status code 500\") {\n                  alert(\"内部出现错误\");\n                } else if (_context3.t0 == \"Error: Request failed with status code 403\") {\n                  alert(\"今天您对改博客的评论已达到上限\");\n                }\n\n              case 19:\n                this.setState({\n                  loadings: {\n                    comment: false\n                  },\n                  saytext: \"\"\n                });\n\n              case 20:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[7, 15]]);\n      }));\n\n      function subMitComment() {\n        return _subMitComment.apply(this, arguments);\n      }\n\n      return subMitComment;\n    }()\n  }, {\n    key: \"makeGood\",\n    value: function () {\n      var _makeGood = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4() {\n        var detailData, id, res;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                detailData = this.state.detailData;\n                id = this.props.query.id;\n                _context4.next = 4;\n                return axios.post(\"\".concat(apiHost, \"/v1/blog/good/make?blog_id=\").concat(id));\n\n              case 4:\n                res = _context4.sent;\n                detailData.goodNum++;\n                this.setState({\n                  detailData: detailData\n                });\n\n              case 7:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function makeGood() {\n        return _makeGood.apply(this, arguments);\n      }\n\n      return makeGood;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          blogDtail = _this$state.blogDtail,\n          detailData = _this$state.detailData,\n          commentsList = _this$state.commentsList,\n          loadings = _this$state.loadings,\n          saytext = _this$state.saytext,\n          commentTotal = _this$state.commentTotal;\n      return React.createElement(Layout, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          background: \"#fff\",\n          padding: \"0 30px\"\n        },\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        className: \"jsx-581838910\" + \" \" + \"news_title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }, detailData.name), React.createElement(\"div\", {\n        className: \"jsx-581838910\" + \" \" + \"bloginfo\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }, React.createElement(\"ul\", {\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }, React.createElement(\"li\", {\n        className: \"jsx-581838910\" + \" \" + \"author\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }), React.createElement(\"li\", {\n        className: \"jsx-581838910\" + \" \" + \"lmname\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      }, getTpValue(detailData.type)), React.createElement(\"li\", {\n        className: \"jsx-581838910\" + \" \" + \"timer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }, moment(detailData.createTime).format(\"YYYY-MM-DD\")), React.createElement(\"li\", {\n        className: \"jsx-581838910\" + \" \" + \"view\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }, detailData.view, \" \\u4EBA\\u5DF2\\u9605\\u8BFB\"))), React.createElement(\"div\", {\n        style: {\n          clear: 'both'\n        },\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"jsx-581838910\" + \" \" + \"news_about\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105\n        },\n        __self: this\n      }, \"\\u7B80\\u4ECB\"), \" \", detailData.preface), React.createElement(\"div\", {\n        dangerouslySetInnerHTML: {\n          __html: blogDtail\n        },\n        previewcontainer: \"true\",\n        style: {\n          width: \"auto\"\n        },\n        className: \"jsx-581838910\" + \" \" + \"markdown-body editormd-preview-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        style: {\n          padding: \"20px\"\n        },\n        className: \"jsx-581838910\" + \" \" + \"share\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: this.makeGood.bind(this),\n        className: \"jsx-581838910\" + \" \" + \"diggit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, \"\\u5F88\\u8D5E\\u54E6\\uFF01\"), \"(\", React.createElement(\"b\", {\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, detailData.goodNum), \")\")), React.createElement(\"div\", {\n        className: \"jsx-581838910\" + \" \" + \"nextinfo\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }, detailData.prev ? React.createElement(\"p\", {\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, \"\\u4E0A\\u4E00\\u7BC7\\uFF1A\", React.createElement(\"a\", {\n        href: \"/detail?id=\".concat(detailData.prev.id),\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, detailData.prev.name)) : React.createElement(\"p\", {\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, \"\\u4E0A\\u4E00\\u7BC7\\uFF1A\", React.createElement(\"a\", {\n        href: \"/article\",\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, \"\\u56DE\\u5230\\u5217\\u8868\")), detailData.next ? React.createElement(\"p\", {\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, \"\\u4E0B\\u4E00\\u7BC7\\uFF1A\", React.createElement(\"a\", {\n        href: \"/detail?id=\".concat(detailData.next.id),\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, detailData.next.name)) : React.createElement(\"p\", {\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, \"\\u4E0B\\u4E00\\u7BC7\\uFF1A\", React.createElement(\"a\", {\n        href: \"/article\",\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, \"\\u56DE\\u5230\\u5217\\u8868\"))), React.createElement(\"div\", {\n        className: \"jsx-581838910\" + \" \" + \"news_pl\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, \"\\u6587\\u7AE0\\u8BC4\\u8BBA\"), React.createElement(\"div\", {\n        className: \"jsx-581838910\" + \" \" + \"gbko\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }, commentsList.map(function (item, k) {\n        return React.createElement(\"div\", {\n          key: k,\n          className: \"jsx-581838910\" + \" \" + \"fb\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        }, React.createElement(\"ul\", {\n          className: \"jsx-581838910\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          style: {\n            color: \"#000\"\n          },\n          className: \"jsx-581838910\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128\n          },\n          __self: this\n        }, item.name), React.createElement(\"p\", {\n          className: \"jsx-581838910\" + \" \" + \"fbtime\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"jsx-581838910\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129\n          },\n          __self: this\n        }, moment(item.createTime).format(\"YYYY-MM-DD\"))), React.createElement(\"p\", {\n          className: \"jsx-581838910\" + \" \" + \"fbinfo\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130\n          },\n          __self: this\n        }, item.content)));\n      }), React.createElement(\"div\", {\n        id: \"plpost\",\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        style: commentsList.length == 0 ? {\n          marginTop: 8\n        } : {},\n        className: \"jsx-581838910\" + \" \" + \"saying\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        href: \"javascript:void(0)\",\n        style: {\n          textDecoration: \"none\",\n          color: \"#de1513\"\n        },\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, \"\\u5171\\u6709\", commentTotal, \"\\u6761\\u8BC4\\u8BBA\")), \"\\u6765\\u8BF4\\u4E24\\u53E5\\u5427...\"), React.createElement(\"textarea\", {\n        name: \"saytext\",\n        value: saytext,\n        onChange: function onChange(e) {\n          _this2.setState({\n            saytext: e.target.value\n          });\n        },\n        rows: \"6\",\n        id: \"saytext\",\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }), React.createElement(\"input\", {\n        name: \"imageField\",\n        type: \"submit\",\n        onClick: this.subMitComment.bind(this),\n        value: \"\\u63D0\\u4EA4\",\n        style: {\n          outline: \"none\",\n          cursor: \"pointer\"\n        },\n        className: \"jsx-581838910\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }))))), React.createElement(_JSXStyle, {\n        id: \"581838910\",\n        __self: this\n      }, \".nextinfo.jsx-581838910 a.jsx-581838910{-webkit-text-decoration:none;text-decoration:none;color:#555;}.nextinfo.jsx-581838910 a.jsx-581838910:hover{-webkit-text-decoration:underline;text-decoration:underline;color:#222;}.yzm.jsx-581838910{margin:10px 10px 10px 0;}#plpost.jsx-581838910 input[type=\\\"submit\\\"].jsx-581838910{display:block;background:#303030;color:#fff;border:0;line-height:30px;padding:0 20px;border-radius:5px;float:right;margin-bottom:20px;margin-top:13px;margin-right:1%;}#saytext.jsx-581838910{width:618px;outline:none;resize:none;}.saying.jsx-581838910 span.jsx-581838910{float:right;}.saying.jsx-581838910{line-height:30px;color:#a9a6a6;margin-bottom:8px;}.news_pl.jsx-581838910 h2.jsx-581838910{border-bottom:#000 2px solid;line-height:40px;font-size:14px;padding-left:10px;color:#000;}.fbtime.jsx-581838910{float:right;color:#999;font-size:12px;width:66px;overflow:hidden;white-space:nowrap;}.fbtime.jsx-581838910 span.jsx-581838910{float:right;color:#999;font-size:12px;width:67px;overflow:hidden;white-space:nowrap;}p.fbtime.jsx-581838910{color:#000;}p.fbinfo.jsx-581838910{margin:10px 0;word-wrap:break-word;}.fb.jsx-581838910 ul.jsx-581838910{margin:10px 10px;padding:10px 10px 10px 70px;border-bottom:#ececec 1px solid;background:url(/static/images/erweima.jpg) no-repeat top 14px left 10px;background-size:47px 47px;}.news_pl.jsx-581838910{margin:10px 0 20px 0;width:100%;overflow:hidden;}.nextinfo.jsx-581838910{line-height:24px;width:100%;overflow:hidden;margin:20px 0;}.nextinfo.jsx-581838910>p.jsx-581838910{padding:4px 10px;border-radius:5px;}.diggit.jsx-581838910{width:160px;margin:auto;background:#E2523A;color:#fff;box-shadow:1px 2px 6px 0px rgba(0,0,0,.2);border-radius:3px;line-height:40px;text-align:center;cursor:pointer;outline:none;display:block;}.news_about.jsx-581838910{color:#888888;border:1px solid #F3F3F3;padding:10px;margin:20px auto 15px auto;line-height:23px;background:none repeat 0 0 #F6F6F6;}.bloginfo.jsx-581838910{width:100%;overflow:hidden;}.news_title.jsx-581838910{font-size:24px;font-weight:normal;padding:20px 0;color:#333;margin:0;}.bloginfo.jsx-581838910 li.jsx-581838910{float:left;margin-right:20px;list-style:none;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qdXN0aW4vRGVza3RvcC9wcml2YXRlL25leHRqcy9wYWdlcy9kZXRhaWwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBb0pzQixBQUdrQyxBQUlLLEFBSUEsQUFHWixBQWFBLEFBS0UsQUFHQyxBQUtZLEFBT2pCLEFBUUEsQUFRRCxBQUdHLEFBSUcsQUFPSSxBQUtKLEFBTUEsQUFJTCxBQWFNLEFBUUwsQUFJTSxBQU9KLFdBNURoQixBQWtEbUIsQUFXSSxDQWpHUCxBQUtqQixBQWVhLEFBUUEsQUFxQ0MsRUE5RU8sQUFvREUsQUF1Q1EsQ0FZTixFQWxGVCxBQW1DYyxBQVlqQixBQU1PLElBWFAsRUE3QkksQUFRQSxDQTdDakIsQUFrRnFCLENBakVMLEVBc0ZkLENBL0JnQixDQTNDQyxBQXFGRyxFQXpGRixDQTBDRixDQS9ETCxDQXVHUSxDQW5EcEIsQUFzQkEsRUE1REQsQ0FvQmEsQUFRQSxDQWlETSxJQVpOLENBOUVGLEFBb0VLLENBYmtCLEFBdURoQyxDQXJGZSxFQXNDaEIsQ0ExQ0EsQUFhaUIsQUFRQSxBQTZERCxDQXBISixFQXdHb0IsQ0ExRmQsQ0E4RXlCLElBVjNDLEVBOUVXLEFBaUhFLENBcEhkLEFBc0NvQixJQVNDLEFBUUEsSUE4RG5CLENBdkdlLENBVmpCLE1BZ0UwRSxFQTdCN0QsQUFpRVUsS0F4RHRCLEFBUUEsQ0F6Q21CLEtBeUJuQixNQW9EbUIsQUFhcUIsT0F6RjNCLFdBNkVLLENBNUVFLGdCQTZFRCxBQVlsQixHQXhGZ0IsZUFtRFUsQUEwQlgsQ0E1RUMsY0E2RUgsRUE1RWYsU0FrREMsRUEyQmUsY0FDZiIsImZpbGUiOiIvVXNlcnMvanVzdGluL0Rlc2t0b3AvcHJpdmF0ZS9uZXh0anMvcGFnZXMvZGV0YWlsLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IExheW91dCBmcm9tICcuLi9jb21wb25lbnRzL2xheW91dCdcbmltcG9ydCB7Z2V0VHBWYWx1ZX0gZnJvbSAnLi4vdXRpbHMvYmxvZ190eXBlcydcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50J1xuaW1wb3J0IHthcGlIb3N0fSBmcm9tICcuLi91dGlscy9jb25maWcnO1xuaW1wb3J0IHByb3RvYnVmIGZyb20gXCIuLi9wcm90by9ibG9nX3BiXCI7XG5pbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnXG5pbXBvcnQgcmVhZFN0cmVhbSBmcm9tICcuLi91dGlscy91dGlsJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIHN0YXRpYyBhc3luYyBnZXRJbml0aWFsUHJvcHMoeyByZXEscXVlcnksanNvblBhZ2VSZXMgfSkge1xuICAgIGNvbnN0IHVzZXJBZ2VudCA9IHJlcSA/IHJlcS5oZWFkZXJzWyd1c2VyLWFnZW50J10gOiBuYXZpZ2F0b3IudXNlckFnZW50XG4gICAgcmV0dXJuIHsgdXNlckFnZW50LHF1ZXJ5LGpzb25QYWdlUmVzIH1cbiAgfVxuXG4gIHN0YXRlID0ge1xuICAgICAgYmxvZ0R0YWlsOlwiXCIsXG4gICAgICBkZXRhaWxEYXRhOnt9LFxuICAgICAgY29tbWVudHNMaXN0OltdLFxuICAgICAgY29tbWVudFRvdGFsOjAsXG4gICAgICBzYXl0ZXh0OlwiXCIsXG4gICAgICBsb2FkaW5nczp7XG4gICAgICAgIFwiY29tbWVudFwiOmZhbHNlXG4gICAgICB9XG4gIH1cblxuICBhc3luYyBnZXRDb21tZW50cygpe1xuICAgIGNvbnN0IHtpZH0gPSB0aGlzLnByb3BzLnF1ZXJ5XG4gICAgdGhpcy5zZXRTdGF0ZSh7bG9hZGluZ3M6e2NvbW1lbnQ6dHJ1ZX19KVxuICAgIGxldCBjb21tZW50UmVzID0gYXdhaXQgYXhpb3MuZ2V0KGAke2FwaUhvc3R9L3YxL2Jsb2cvbWVzc2FnZWJvYXJkL2xpc3Q/YmxvZ19pZD0ke2lkfWAse1xuICAgICAgcmVzcG9uc2VUeXBlOiAnYmxvYidcbiAgICB9KVxuICAgIGxldCBjb21tZW50RGF0YSA9IGF3YWl0IHJlYWRTdHJlYW0oY29tbWVudFJlcy5kYXRhKTtcbiAgICBsZXQgY29tbWVudE1lc3NhZ2UgPSBwcm90b2J1Zi5ibG9nQ29tbWVudHMuZGVzZXJpYWxpemVCaW5hcnkoY29tbWVudERhdGEpO1xuICAgIGNvbW1lbnRNZXNzYWdlID0gY29tbWVudE1lc3NhZ2UudG9PYmplY3QoKTtcbiAgICB0aGlzLnNldFN0YXRlKHtjb21tZW50c0xpc3Q6Y29tbWVudE1lc3NhZ2UubGlzdExpc3QsY29tbWVudFRvdGFsOmNvbW1lbnRNZXNzYWdlLnRvdGFsfSlcbiAgfVxuXG4gIGFzeW5jIGNvbXBvbmVudERpZE1vdW50KCl7XG4gICAgICBjb25zdCB7aWR9ID0gdGhpcy5wcm9wcy5xdWVyeVxuICAgICAgbGV0IHJlcyA9IGF3YWl0IGF4aW9zLmdldChgJHthcGlIb3N0fS92MS9ibG9nL2RldGFpbD9pZD0ke2lkfWAse1xuICAgICAgICByZXNwb25zZVR5cGU6ICdibG9iJ1xuICAgICAgfSlcbiAgICAgIGxldCBkYXRhID0gYXdhaXQgcmVhZFN0cmVhbShyZXMuZGF0YSk7XG4gICAgICBsZXQgbWVzc2FnZSA9IHByb3RvYnVmLmRldGFpbFJlcy5kZXNlcmlhbGl6ZUJpbmFyeShkYXRhKTtcbiAgICAgIGRhdGEgPSBtZXNzYWdlLnRvT2JqZWN0KCk7XG4gICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKVxuICAgICAgbGV0IGhyZXMgPSBhd2FpdCBheGlvcy5nZXQoYCR7YXBpSG9zdH0vdG9vbC9maWxlL3JlYWQ/a2V5PSR7ZGF0YS5odG1sVHh0VXJsfWAse1xuICAgICAgICByZXNwb25zZVR5cGU6ICdibG9iJ1xuICAgICAgfSlcbiAgICAgIGxldCBoZGF0YSA9IGF3YWl0IHJlYWRTdHJlYW0oaHJlcy5kYXRhKTtcbiAgICAgIGxldCBobWVzc2FnZSA9IHByb3RvYnVmLmZpbGVSZWFkUmVzLmRlc2VyaWFsaXplQmluYXJ5KGhkYXRhKTtcbiAgICAgIGhkYXRhID0gaG1lc3NhZ2UudG9PYmplY3QoKTtcbiAgICAgIGF3YWl0IHRoaXMuZ2V0Q29tbWVudHMoKTtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe2Jsb2dEdGFpbDpoZGF0YS50eHQsZGV0YWlsRGF0YTpkYXRhfSlcbiAgfVxuXG4gIGFzeW5jIHN1Yk1pdENvbW1lbnQoKXtcbiAgICB0aGlzLnNldFN0YXRlKHtsb2FkaW5nczp7Y29tbWVudDp0cnVlfX0pXG4gICAgY29uc3Qge3NheXRleHR9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB7aWR9ID0gdGhpcy5wcm9wcy5xdWVyeVxuICAgIGxldCBtZXNzYWdlID0gbmV3IHByb3RvYnVmLmJsb2dDb21tZW50KCk7XG4gICAgICAgIG1lc3NhZ2Uuc2V0Q29udGVudChzYXl0ZXh0KTtcbiAgICAgICAgbWVzc2FnZS5zZXRCbG9nSWQoaWQpO1xuICAgIGxldCBieXRlcyA9IG1lc3NhZ2Uuc2VyaWFsaXplQmluYXJ5KCk7XG4gICAgdHJ5IHtcbiAgICAgIGxldCByZXMgPSBhd2FpdCBheGlvcy5wb3N0KGAke2FwaUhvc3R9L3YxL2Jsb2cvbWVzc2FnZWJvYXJkL3N1Ym1pdGAsYnl0ZXMse2hlYWRlcnM6IHsnQ29udGVudC1UeXBlJzonYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJ319KVxuICAgICAgYXdhaXQgdGhpcy5nZXRDb21tZW50cygpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcilcbiAgICAgIGlmKGVycm9yID09IFwiRXJyb3I6IFJlcXVlc3QgZmFpbGVkIHdpdGggc3RhdHVzIGNvZGUgNDAwXCIpe1xuICAgICAgICBhbGVydChcIuivhOiuuuWGheWuueS4jeiDveS4uuepulwiKVxuICAgICAgfWVsc2UgaWYoZXJyb3IgPT0gXCJFcnJvcjogUmVxdWVzdCBmYWlsZWQgd2l0aCBzdGF0dXMgY29kZSA1MDBcIil7XG4gICAgICAgIGFsZXJ0KFwi5YaF6YOo5Ye6546w6ZSZ6K+vXCIpXG4gICAgICB9ZWxzZSBpZihlcnJvciA9PSBcIkVycm9yOiBSZXF1ZXN0IGZhaWxlZCB3aXRoIHN0YXR1cyBjb2RlIDQwM1wiKXtcbiAgICAgICAgYWxlcnQoXCLku4rlpKnmgqjlr7nmlLnljZrlrqLnmoTor4Torrrlt7Lovr7liLDkuIrpmZBcIilcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5zZXRTdGF0ZSh7bG9hZGluZ3M6e2NvbW1lbnQ6ZmFsc2V9LHNheXRleHQ6XCJcIn0pXG4gIH1cblxuICBhc3luYyBtYWtlR29vZCgpe1xuICAgIGxldCB7ZGV0YWlsRGF0YX0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHtpZH0gPSB0aGlzLnByb3BzLnF1ZXJ5XG4gICAgbGV0IHJlcyA9IGF3YWl0IGF4aW9zLnBvc3QoYCR7YXBpSG9zdH0vdjEvYmxvZy9nb29kL21ha2U/YmxvZ19pZD0ke2lkfWApXG4gICAgZGV0YWlsRGF0YS5nb29kTnVtKytcbiAgICB0aGlzLnNldFN0YXRlKHtkZXRhaWxEYXRhfSlcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7YmxvZ0R0YWlsLGRldGFpbERhdGEsY29tbWVudHNMaXN0LGxvYWRpbmdzLHNheXRleHQsY29tbWVudFRvdGFsfSA9IHRoaXMuc3RhdGVcbiAgICByZXR1cm4gKFxuICAgICAgPExheW91dD5cbiAgICAgICAgICA8ZGl2IHN0eWxlPXt7YmFja2dyb3VuZDpcIiNmZmZcIixwYWRkaW5nOiBcIjAgMzBweFwifX0+XG4gICAgICAgICAgICA8aDMgY2xhc3NOYW1lPVwibmV3c190aXRsZVwiPntkZXRhaWxEYXRhLm5hbWV9PC9oMz5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYmxvZ2luZm9cIj5cbiAgICAgICAgICAgICAgPHVsPlxuICAgICAgICAgICAgICAgIDxsaSBjbGFzc05hbWU9XCJhdXRob3JcIj48L2xpPlxuICAgICAgICAgICAgICAgIDxsaSBjbGFzc05hbWU9XCJsbW5hbWVcIj57Z2V0VHBWYWx1ZShkZXRhaWxEYXRhLnR5cGUpfTwvbGk+XG4gICAgICAgICAgICAgICAgPGxpIGNsYXNzTmFtZT1cInRpbWVyXCI+e21vbWVudChkZXRhaWxEYXRhLmNyZWF0ZVRpbWUpLmZvcm1hdChcIllZWVktTU0tRERcIil9PC9saT5cbiAgICAgICAgICAgICAgICA8bGkgY2xhc3NOYW1lPVwidmlld1wiPntkZXRhaWxEYXRhLnZpZXd9IOS6uuW3sumYheivuzwvbGk+XG4gICAgICAgICAgICAgIDwvdWw+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgc3R5bGU9e3tjbGVhcjonYm90aCd9fT48L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibmV3c19hYm91dFwiPlxuICAgICAgICAgICAgICA8c3Ryb25nPueugOS7izwvc3Ryb25nPiB7ZGV0YWlsRGF0YS5wcmVmYWNlfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiBibG9nRHRhaWx9fSBjbGFzc05hbWU9XCJtYXJrZG93bi1ib2R5IGVkaXRvcm1kLXByZXZpZXctY29udGFpbmVyXCIgcHJldmlld2NvbnRhaW5lcj1cInRydWVcIiBzdHlsZT17e3dpZHRoOlwiYXV0b1wifX0+PC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNoYXJlXCIgc3R5bGU9e3twYWRkaW5nOiBcIjIwcHhcIn19PlxuICAgICAgICAgICAgIDxidXR0b24gY2xhc3NOYW1lPVwiZGlnZ2l0XCIgb25DbGljaz17dGhpcy5tYWtlR29vZC5iaW5kKHRoaXMpfT5cbiAgICAgICAgICAgICAgIDxhPuW+iOi1nuWTpu+8gTwvYT4oPGI+e2RldGFpbERhdGEuZ29vZE51bX08L2I+KVxuICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm5leHRpbmZvXCI+XG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZXRhaWxEYXRhLnByZXYgPyA8cD7kuIrkuIDnr4fvvJo8YSBocmVmPXtgL2RldGFpbD9pZD0ke2RldGFpbERhdGEucHJldi5pZH1gfT57ZGV0YWlsRGF0YS5wcmV2Lm5hbWV9PC9hPjwvcD46PHA+5LiK5LiA56+H77yaPGEgaHJlZj17YC9hcnRpY2xlYH0+5Zue5Yiw5YiX6KGoPC9hPjwvcD5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGV0YWlsRGF0YS5uZXh0ID8gPHA+5LiL5LiA56+H77yaPGEgaHJlZj17YC9kZXRhaWw/aWQ9JHtkZXRhaWxEYXRhLm5leHQuaWR9YH0+e2RldGFpbERhdGEubmV4dC5uYW1lfTwvYT48L3A+OjxwPuS4i+S4gOevh++8mjxhIGhyZWY9e2AvYXJ0aWNsZWB9PuWbnuWIsOWIl+ihqDwvYT48L3A+XG4gICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibmV3c19wbFwiPlxuICAgICAgICAgICAgICAgIDxoMj7mlofnq6Dor4Torro8L2gyPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ2Jrb1wiPlxuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb21tZW50c0xpc3QubWFwKChpdGVtLGspPT4oXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBrZXk9e2t9IGNsYXNzTmFtZT1cImZiXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIHN0eWxlPXt7Y29sb3I6XCIjMDAwXCJ9fT57aXRlbS5uYW1lfTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiZmJ0aW1lXCI+PHNwYW4+e21vbWVudChpdGVtLmNyZWF0ZVRpbWUpLmZvcm1hdChcIllZWVktTU0tRERcIil9PC9zcGFuPjwvcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiZmJpbmZvXCI+e2l0ZW0uY29udGVudH08L3A+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3VsPlxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PiBcbiAgICAgICAgICAgICAgICAgICAgKSlcbiAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgPGRpdiBpZD1cInBscG9zdFwiPlxuICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJzYXlpbmdcIiBzdHlsZT17Y29tbWVudHNMaXN0Lmxlbmd0aCA9PSAwID8ge21hcmdpblRvcDogOH06e319PlxuICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPjxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMClcIiBzdHlsZT17e3RleHREZWNvcmF0aW9uOiBcIm5vbmVcIixjb2xvcjogXCIjZGUxNTEzXCJ9fT7lhbHmnIl7Y29tbWVudFRvdGFsfeadoeivhOiuujwvYT48L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAg5p2l6K+05Lik5Y+l5ZCnLi4uXG4gICAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgICAgPHRleHRhcmVhIG5hbWU9XCJzYXl0ZXh0XCIgdmFsdWU9e3NheXRleHR9IG9uQ2hhbmdlPXsoZSk9PntcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtzYXl0ZXh0OmUudGFyZ2V0LnZhbHVlfSlcbiAgICAgICAgICAgICAgICAgICAgfX0gcm93cz1cIjZcIiBpZD1cInNheXRleHRcIj48L3RleHRhcmVhPlxuICAgICAgICAgICAgICAgICAgICA8aW5wdXQgbmFtZT1cImltYWdlRmllbGRcIiB0eXBlPVwic3VibWl0XCIgb25DbGljaz17dGhpcy5zdWJNaXRDb21tZW50LmJpbmQodGhpcyl9IHZhbHVlPVwi5o+Q5LqkXCIgc3R5bGU9e3tvdXRsaW5lOiBcIm5vbmVcIixjdXJzb3I6IFwicG9pbnRlclwifX0gLz5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8c3R5bGUganN4PntgXG4gICAgICAgICAgLm5leHRpbmZvIGF7XG4gICAgICAgICAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XG4gICAgICAgICAgICBjb2xvcjogIzU1NTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLm5leHRpbmZvIGE6aG92ZXJ7XG4gICAgICAgICAgICB0ZXh0LWRlY29yYXRpb246IHVuZGVybGluZTtcbiAgICAgICAgICAgIGNvbG9yOiMyMjI7XG4gICAgICAgICAgfVxuICAgICAgICAgIC55em0ge1xuICAgICAgICAgICAgICBtYXJnaW46IDEwcHggMTBweCAxMHB4IDA7XG4gICAgICAgICAgfVxuICAgICAgICAgICNwbHBvc3QgaW5wdXRbdHlwZT1cInN1Ym1pdFwiXSB7XG4gICAgICAgICAgICBkaXNwbGF5OiBibG9jaztcbiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMzMDMwMzA7XG4gICAgICAgICAgICBjb2xvcjogI2ZmZjtcbiAgICAgICAgICAgIGJvcmRlcjogMDtcbiAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAzMHB4O1xuICAgICAgICAgICAgcGFkZGluZzogMCAyMHB4O1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNXB4O1xuICAgICAgICAgICAgZmxvYXQ6IHJpZ2h0O1xuICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMjBweDtcbiAgICAgICAgICAgIG1hcmdpbi10b3A6IDEzcHg7XG4gICAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDElO1xuICAgICAgICAgIH1cbiAgICAgICAgICAjc2F5dGV4dCB7XG4gICAgICAgICAgICAgIHdpZHRoOiA2MThweDtcbiAgICAgICAgICAgICAgb3V0bGluZTogbm9uZTtcbiAgICAgICAgICAgICAgcmVzaXplOiBub25lO1xuICAgICAgICAgIH1cbiAgICAgICAgICAuc2F5aW5nIHNwYW4ge1xuICAgICAgICAgICAgICAgIGZsb2F0OiByaWdodDtcbiAgICAgICAgICB9XG4gICAgICAgICAgIC5zYXlpbmd7XG4gICAgICAgICAgICBsaW5lLWhlaWdodDogMzBweDtcbiAgICAgICAgICAgIGNvbG9yOiAjYTlhNmE2O1xuICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogOHB4O1xuICAgICAgICAgICB9IFxuICAgICAgICAgICAubmV3c19wbCBoMntcbiAgICAgICAgICAgIGJvcmRlci1ib3R0b206ICMwMDAgMnB4IHNvbGlkO1xuICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDQwcHg7XG4gICAgICAgICAgICBmb250LXNpemU6IDE0cHg7XG4gICAgICAgICAgICBwYWRkaW5nLWxlZnQ6IDEwcHg7XG4gICAgICAgICAgICBjb2xvcjogIzAwMDtcbiAgICAgICAgICAgfVxuICAgICAgICAgICAuZmJ0aW1le1xuICAgICAgICAgICAgZmxvYXQ6IHJpZ2h0O1xuICAgICAgICAgICAgY29sb3I6ICM5OTk7XG4gICAgICAgICAgICBmb250LXNpemU6IDEycHg7XG4gICAgICAgICAgICB3aWR0aDogNjZweDtcbiAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47XG4gICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICAgICAgICAgICB9XG4gICAgICAgICAgIC5mYnRpbWUgc3BhbntcbiAgICAgICAgICAgIGZsb2F0OiByaWdodDtcbiAgICAgICAgICAgIGNvbG9yOiAjOTk5O1xuICAgICAgICAgICAgZm9udC1zaXplOiAxMnB4O1xuICAgICAgICAgICAgd2lkdGg6IDY3cHg7XG4gICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgICAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgICAgICAgICAgfVxuICAgICAgICAgICBwLmZidGltZXtcbiAgICAgICAgICAgIGNvbG9yOiAjMDAwO1xuICAgICAgICAgICB9XG4gICAgICAgICAgIHAuZmJpbmZve1xuICAgICAgICAgICAgbWFyZ2luOiAxMHB4IDA7XG4gICAgICAgICAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7XG4gICAgICAgICAgIH1cbiAgICAgICAgICAgLmZiIHVse1xuICAgICAgICAgICAgbWFyZ2luOiAxMHB4IDEwcHg7XG4gICAgICAgICAgICBwYWRkaW5nOiAxMHB4IDEwcHggMTBweCA3MHB4O1xuICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogI2VjZWNlYyAxcHggc29saWQ7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiB1cmwoL3N0YXRpYy9pbWFnZXMvZXJ3ZWltYS5qcGcpIG5vLXJlcGVhdCB0b3AgMTRweCBsZWZ0IDEwcHg7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLXNpemU6IDQ3cHggNDdweDtcbiAgICAgICAgICAgfSAgXG4gICAgICAgICAgIC5uZXdzX3Bse1xuICAgICAgICAgICAgbWFyZ2luOiAxMHB4IDAgMjBweCAwO1xuICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgICAgICAgICB9XG4gICAgICAgICAgIC5uZXh0aW5mb3tcbiAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAyNHB4O1xuICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgICAgICAgICAgbWFyZ2luOiAyMHB4IDA7XG4gICAgICAgICAgIH1cbiAgICAgICAgICAgLm5leHRpbmZvID4gcHtcbiAgICAgICAgICAgIHBhZGRpbmc6IDRweCAxMHB4O1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNXB4O1xuICAgICAgICAgICB9XG4gICAgICAgICAgIC5kaWdnaXR7XG4gICAgICAgICAgICB3aWR0aDogMTYwcHg7XG4gICAgICAgICAgICBtYXJnaW46IGF1dG87XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiAjRTI1MjNBO1xuICAgICAgICAgICAgY29sb3I6ICNmZmY7XG4gICAgICAgICAgICBib3gtc2hhZG93OiAxcHggMnB4IDZweCAwcHggcmdiYSgwLDAsMCwuMik7XG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiAzcHg7XG4gICAgICAgICAgICBsaW5lLWhlaWdodDogNDBweDtcbiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgICAgIG91dGxpbmU6IG5vbmU7XG4gICAgICAgICAgICBkaXNwbGF5OiBibG9jaztcbiAgICAgICAgICAgfVxuICAgICAgICAgICAubmV3c19hYm91dCB7XG4gICAgICAgICAgICAgICAgY29sb3I6ICM4ODg4ODg7XG4gICAgICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI0YzRjNGMztcbiAgICAgICAgICAgICAgICBwYWRkaW5nOiAxMHB4O1xuICAgICAgICAgICAgICAgIG1hcmdpbjogMjBweCBhdXRvIDE1cHggYXV0bztcbiAgICAgICAgICAgICAgICBsaW5lLWhlaWdodDogMjNweDtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiBub25lIHJlcGVhdCAwIDAgI0Y2RjZGNjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC5ibG9naW5mbyB7XG4gICAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLm5ld3NfdGl0bGUge1xuICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMjRweDtcbiAgICAgICAgICAgICAgICBmb250LXdlaWdodDogbm9ybWFsO1xuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDIwcHggMDtcbiAgICAgICAgICAgICAgICBjb2xvcjogIzMzMztcbiAgICAgICAgICAgICAgICBtYXJnaW46MDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC5ibG9naW5mbyBsaSB7XG4gICAgICAgICAgICAgICAgZmxvYXQ6IGxlZnQ7XG4gICAgICAgICAgICAgICAgbWFyZ2luLXJpZ2h0OiAyMHB4O1xuICAgICAgICAgICAgICAgIGxpc3Qtc3R5bGU6IG5vbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgYH08L3N0eWxlPlxuICAgICAgPC9MYXlvdXQ+ICAgICBcbiAgICApXG4gIH1cbn1cblxuXG4iXX0= */\\n/*@ sourceURL=/Users/justin/Desktop/private/nextjs/pages/detail.js */\"));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(_ref) {\n        var req, query, jsonPageRes, userAgent;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                req = _ref.req, query = _ref.query, jsonPageRes = _ref.jsonPageRes;\n                userAgent = req ? req.headers['user-agent'] : navigator.userAgent;\n                return _context5.abrupt(\"return\", {\n                  userAgent: userAgent,\n                  query: query,\n                  jsonPageRes: jsonPageRes\n                });\n\n              case 3:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5);\n      }));\n\n      function getInitialProps(_x) {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  return _default;\n}(React.Component);\n\nexport { _default as default };","map":{"version":3,"sources":["/Users/justin/Desktop/private/nextjs/pages/detail.js"],"names":["Layout","getTpValue","moment","apiHost","protobuf","axios","readStream","blogDtail","detailData","commentsList","commentTotal","saytext","loadings","id","props","query","setState","comment","get","responseType","commentRes","data","commentData","commentMessage","blogComments","deserializeBinary","toObject","listList","total","res","message","detailRes","htmlTxtUrl","hres","hdata","hmessage","fileReadRes","getComments","txt","state","blogComment","setContent","setBlogId","bytes","serializeBinary","post","headers","console","log","alert","goodNum","background","padding","name","type","createTime","format","view","clear","preface","__html","width","makeGood","bind","prev","next","map","item","k","color","content","length","marginTop","textDecoration","e","target","value","subMitComment","outline","cursor","req","jsonPageRes","userAgent","navigator","React","Component"],"mappings":"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","sourcesContent":["import Layout from '../components/layout'\nimport {getTpValue} from '../utils/blog_types'\nimport moment from 'moment'\nimport {apiHost} from '../utils/config';\nimport protobuf from \"../proto/blog_pb\";\nimport axios from 'axios'\nimport readStream from '../utils/util'\n\nexport default class extends React.Component {\n  static async getInitialProps({ req,query,jsonPageRes }) {\n    const userAgent = req ? req.headers['user-agent'] : navigator.userAgent\n    return { userAgent,query,jsonPageRes }\n  }\n\n  state = {\n      blogDtail:\"\",\n      detailData:{},\n      commentsList:[],\n      commentTotal:0,\n      saytext:\"\",\n      loadings:{\n        \"comment\":false\n      }\n  }\n\n  async getComments(){\n    const {id} = this.props.query\n    this.setState({loadings:{comment:true}})\n    let commentRes = await axios.get(`${apiHost}/v1/blog/messageboard/list?blog_id=${id}`,{\n      responseType: 'blob'\n    })\n    let commentData = await readStream(commentRes.data);\n    let commentMessage = protobuf.blogComments.deserializeBinary(commentData);\n    commentMessage = commentMessage.toObject();\n    this.setState({commentsList:commentMessage.listList,commentTotal:commentMessage.total})\n  }\n\n  async componentDidMount(){\n      const {id} = this.props.query\n      let res = await axios.get(`${apiHost}/v1/blog/detail?id=${id}`,{\n        responseType: 'blob'\n      })\n      let data = await readStream(res.data);\n      let message = protobuf.detailRes.deserializeBinary(data);\n      data = message.toObject();\n      // console.log(data)\n      let hres = await axios.get(`${apiHost}/tool/file/read?key=${data.htmlTxtUrl}`,{\n        responseType: 'blob'\n      })\n      let hdata = await readStream(hres.data);\n      let hmessage = protobuf.fileReadRes.deserializeBinary(hdata);\n      hdata = hmessage.toObject();\n      await this.getComments();\n      this.setState({blogDtail:hdata.txt,detailData:data})\n  }\n\n  async subMitComment(){\n    this.setState({loadings:{comment:true}})\n    const {saytext} = this.state;\n    const {id} = this.props.query\n    let message = new protobuf.blogComment();\n        message.setContent(saytext);\n        message.setBlogId(id);\n    let bytes = message.serializeBinary();\n    try {\n      let res = await axios.post(`${apiHost}/v1/blog/messageboard/submit`,bytes,{headers: {'Content-Type':'application/octet-stream'}})\n      await this.getComments();\n    } catch (error) {\n      console.log(error)\n      if(error == \"Error: Request failed with status code 400\"){\n        alert(\"评论内容不能为空\")\n      }else if(error == \"Error: Request failed with status code 500\"){\n        alert(\"内部出现错误\")\n      }else if(error == \"Error: Request failed with status code 403\"){\n        alert(\"今天您对改博客的评论已达到上限\")\n      }\n    }\n    this.setState({loadings:{comment:false},saytext:\"\"})\n  }\n\n  async makeGood(){\n    let {detailData} = this.state;\n    const {id} = this.props.query\n    let res = await axios.post(`${apiHost}/v1/blog/good/make?blog_id=${id}`)\n    detailData.goodNum++\n    this.setState({detailData})\n  }\n\n  render() {\n    const {blogDtail,detailData,commentsList,loadings,saytext,commentTotal} = this.state\n    return (\n      <Layout>\n          <div style={{background:\"#fff\",padding: \"0 30px\"}}>\n            <h3 className=\"news_title\">{detailData.name}</h3>\n            <div className=\"bloginfo\">\n              <ul>\n                <li className=\"author\"></li>\n                <li className=\"lmname\">{getTpValue(detailData.type)}</li>\n                <li className=\"timer\">{moment(detailData.createTime).format(\"YYYY-MM-DD\")}</li>\n                <li className=\"view\">{detailData.view} 人已阅读</li>\n              </ul>\n            </div>\n            <div style={{clear:'both'}}></div>\n            <div className=\"news_about\">\n              <strong>简介</strong> {detailData.preface}\n            </div>\n            <div dangerouslySetInnerHTML={{__html: blogDtail}} className=\"markdown-body editormd-preview-container\" previewcontainer=\"true\" style={{width:\"auto\"}}></div>\n            <div className=\"share\" style={{padding: \"20px\"}}>\n             <button className=\"diggit\" onClick={this.makeGood.bind(this)}>\n               <a>很赞哦！</a>(<b>{detailData.goodNum}</b>)\n             </button>\n            </div>\n            <div className=\"nextinfo\">\n              {\n                detailData.prev ? <p>上一篇：<a href={`/detail?id=${detailData.prev.id}`}>{detailData.prev.name}</a></p>:<p>上一篇：<a href={`/article`}>回到列表</a></p>\n              }\n              {\n                detailData.next ? <p>下一篇：<a href={`/detail?id=${detailData.next.id}`}>{detailData.next.name}</a></p>:<p>下一篇：<a href={`/article`}>回到列表</a></p>\n              } \n            </div>\n            <div className=\"news_pl\">\n                <h2>文章评论</h2>\n                <div className=\"gbko\">\n                  {\n                    commentsList.map((item,k)=>(\n                      <div key={k} className=\"fb\">\n                        <ul>\n                          <span style={{color:\"#000\"}}>{item.name}</span>\n                          <p className=\"fbtime\"><span>{moment(item.createTime).format(\"YYYY-MM-DD\")}</span></p>\n                          <p className=\"fbinfo\">{item.content}</p>\n                        </ul>\n                      </div> \n                    ))\n                  }                 \n                  <div id=\"plpost\">\n                    <p className=\"saying\" style={commentsList.length == 0 ? {marginTop: 8}:{}}>\n                      <span><a href=\"javascript:void(0)\" style={{textDecoration: \"none\",color: \"#de1513\"}}>共有{commentTotal}条评论</a></span>\n                      来说两句吧...\n                    </p>\n                    <textarea name=\"saytext\" value={saytext} onChange={(e)=>{\n                      this.setState({saytext:e.target.value})\n                    }} rows=\"6\" id=\"saytext\"></textarea>\n                    <input name=\"imageField\" type=\"submit\" onClick={this.subMitComment.bind(this)} value=\"提交\" style={{outline: \"none\",cursor: \"pointer\"}} />\n                  </div>\n                </div>\n            </div>\n\n          </div>\n          <style jsx>{`\n          .nextinfo a{\n            text-decoration: none;\n            color: #555;\n          }\n          .nextinfo a:hover{\n            text-decoration: underline;\n            color:#222;\n          }\n          .yzm {\n              margin: 10px 10px 10px 0;\n          }\n          #plpost input[type=\"submit\"] {\n            display: block;\n            background: #303030;\n            color: #fff;\n            border: 0;\n            line-height: 30px;\n            padding: 0 20px;\n            border-radius: 5px;\n            float: right;\n            margin-bottom: 20px;\n            margin-top: 13px;\n            margin-right: 1%;\n          }\n          #saytext {\n              width: 618px;\n              outline: none;\n              resize: none;\n          }\n          .saying span {\n                float: right;\n          }\n           .saying{\n            line-height: 30px;\n            color: #a9a6a6;\n            margin-bottom: 8px;\n           } \n           .news_pl h2{\n            border-bottom: #000 2px solid;\n            line-height: 40px;\n            font-size: 14px;\n            padding-left: 10px;\n            color: #000;\n           }\n           .fbtime{\n            float: right;\n            color: #999;\n            font-size: 12px;\n            width: 66px;\n            overflow: hidden;\n            white-space: nowrap;\n           }\n           .fbtime span{\n            float: right;\n            color: #999;\n            font-size: 12px;\n            width: 67px;\n            overflow: hidden;\n            white-space: nowrap;\n           }\n           p.fbtime{\n            color: #000;\n           }\n           p.fbinfo{\n            margin: 10px 0;\n            word-wrap: break-word;\n           }\n           .fb ul{\n            margin: 10px 10px;\n            padding: 10px 10px 10px 70px;\n            border-bottom: #ececec 1px solid;\n            background: url(/static/images/erweima.jpg) no-repeat top 14px left 10px;\n            background-size: 47px 47px;\n           }  \n           .news_pl{\n            margin: 10px 0 20px 0;\n            width: 100%;\n            overflow: hidden;\n           }\n           .nextinfo{\n            line-height: 24px;\n            width: 100%;\n            overflow: hidden;\n            margin: 20px 0;\n           }\n           .nextinfo > p{\n            padding: 4px 10px;\n            border-radius: 5px;\n           }\n           .diggit{\n            width: 160px;\n            margin: auto;\n            background: #E2523A;\n            color: #fff;\n            box-shadow: 1px 2px 6px 0px rgba(0,0,0,.2);\n            border-radius: 3px;\n            line-height: 40px;\n            text-align: center;\n            cursor: pointer;\n            outline: none;\n            display: block;\n           }\n           .news_about {\n                color: #888888;\n                border: 1px solid #F3F3F3;\n                padding: 10px;\n                margin: 20px auto 15px auto;\n                line-height: 23px;\n                background: none repeat 0 0 #F6F6F6;\n            }\n            .bloginfo {\n              width: 100%;\n              overflow: hidden;\n            }\n            .news_title {\n                font-size: 24px;\n                font-weight: normal;\n                padding: 20px 0;\n                color: #333;\n                margin:0;\n            }\n            .bloginfo li {\n                float: left;\n                margin-right: 20px;\n                list-style: none;\n            }\n          `}</style>\n      </Layout>     \n    )\n  }\n}\n\n\n"]},"metadata":{},"sourceType":"module"}